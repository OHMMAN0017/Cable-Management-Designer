<!DOCTYPE html>
<html lang="th">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Cable Containment Pro</title>

<style>
body{
    font-family: system-ui, -apple-system, sans-serif;
    background:#fffafb;
    margin:0;
    padding:20px;
}

.container{
    max-width:480px;
    margin:auto;
}

.card{
    background:white;
    padding:20px;
    border-radius:20px;
    box-shadow:0 10px 25px rgba(231,2,116,0.1);
    margin-bottom:20px;
}

h1{
    text-align:center;
    color:#e70274;
}

select,input{
    width:100%;
    padding:12px;
    margin-top:5px;
    margin-bottom:15px;
    border-radius:12px;
    border:1px solid #ddd;
    font-size:16px;
}

button{
    width:100%;
    padding:14px;
    border:none;
    border-radius:14px;
    background:linear-gradient(135deg,#e70274,#ff5e9e);
    color:white;
    font-weight:bold;
    font-size:16px;
}

.result{
    background:#ffeaf4;
    padding:15px;
    border-radius:15px;
    margin-top:10px;
}

.option{
    padding:12px;
    border-bottom:1px solid #eee;
}

.best{
    border:2px solid #e70274;
    background:#fff0f6;
}
</style>
</head>

<body>

<div class="container">

<h1>Cable Containment Pro</h1>

<div class="card">

<label>ประเภทสาย</label>
<select id="cableType"></select>

<label>ขนาด (mm²)</label>
<select id="cableSize"></select>

<label>จำนวน (เส้น)</label>
<input type="number" id="cableQty" value="4">

<label>วิธีติดตั้ง</label>
<select id="installType">
<option value="conduit">ท่อ EMT</option>
<option value="wireway">ราง Wireway</option>
</select>

<button onclick="calculate()">คำนวณ</button>

</div>

<div id="result"></div>

</div>

<script>
const cableData = {
    iec01: { "1.5":8.5,"2.5":12.5,"4":16.6,"6":21.2,"10":35.2,"16":47.7,"25":73.8,"35":93.9,"50":129 },
    nyy1c: { "1":60.8,"1.5":66.5,"2.5":75.4,"4":86.6,"6":95,"10":113,"16":133 },
    xlpe1c: { "1.5":33.1,"2.5":38.4,"4":44.1,"6":50.2,"10":56.7,"16":70.8 }
};

const conduitData = [
    { name:'1/2"', area:71, price:145 },
    { name:'3/4"', area:126, price:195 },
    { name:'1"', area:196, price:290 },
    { name:'1 1/4"', area:322, price:420 },
    { name:'1 1/2"', area:503, price:550 },
    { name:'2"', area:785, price:780 }
];

const wirewayData = [
    { name:"50x75", area:750, price:380 },
    { name:"50x100", area:1000, price:450 },
    { name:"75x100", area:1500, price:580 },
    { name:"100x100", area:2000, price:720 }
];

const cableTypeSelect = document.getElementById("cableType");
const cableSizeSelect = document.getElementById("cableSize");

Object.keys(cableData).forEach(type=>{
    let opt=document.createElement("option");
    opt.value=type;
    opt.text=type.toUpperCase();
    cableTypeSelect.appendChild(opt);
});

function updateSizes(){
    cableSizeSelect.innerHTML="";
    let type=cableTypeSelect.value;
    Object.keys(cableData[type]).forEach(size=>{
        let opt=document.createElement("option");
        opt.value=size;
        opt.text=size;
        cableSizeSelect.appendChild(opt);
    });
}

cableTypeSelect.addEventListener("change",updateSizes);
updateSizes();

function calculate(){
    let type=cableTypeSelect.value;
    let size=cableSizeSelect.value;
    let qty=parseInt(document.getElementById("cableQty").value);
    let install=document.getElementById("installType").value;

    if(!qty||qty<=0){alert("กรอกจำนวนให้ถูกต้อง");return;}

    let totalArea=cableData[type][size]*qty;

    let master=install==="conduit"?conduitData:wirewayData;

    master.sort((a,b)=>a.area-b.area);

    let options=master.filter(x=>x.area>=totalArea);

    let resultDiv=document.getElementById("result");
    resultDiv.innerHTML="";

    if(options.length===0){
        resultDiv.innerHTML="<div class='card'>ไม่มีขนาดที่รองรับ</div>";
        return;
    }

    let best=options[0];

    let html="<div class='card result'>";
    html+="<b>แนะนำ: "+best.name+"</b><br>";
    html+="ราคาโดยประมาณ: ฿"+best.price.toLocaleString();
    html+="</div>";

    html+="<div class='card'>";
    options.forEach((opt,i)=>{
        html+="<div class='option "+(i===0?"best":"")+"'>";
        html+=opt.name+" — ฿"+opt.price.toLocaleString();
        if(i===0) html+=" (ประหยัดสุด)";
        html+="</div>";
    });
    html+="</div>";

    resultDiv.innerHTML=html;
}
</script>

</body>
</html>