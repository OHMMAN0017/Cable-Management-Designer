<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>SPU Cable Calc Pro — Table 4.7 Standard</title>
    <link href="https://fonts.googleapis.com/css2?family=Kanit:wght@300;400;500;600;700&family=Space+Mono:wght@400;700&display=swap" rel="stylesheet">
    <style>
        /* CSS ปรับปรุงเพื่อความชัดเจนของข้อมูล */
        *, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }
        :root {
            --spu: #e70274; --spu-pale: #fff0f7; --ink: #1a0a12; --ink-soft: #6b4a5a;
            --surface: #fffafb; --card: #ffffff; --border: rgba(231, 2, 116, 0.08);
            --shadow: 0 8px 32px -8px rgba(231, 2, 116, 0.18); --radius: 1.25rem;
        }
        body { font-family: 'Kanit', sans-serif; background: var(--surface); color: var(--ink); min-height: 100vh; padding-bottom: 50px; }
        .header { background: rgba(255, 255, 255, 0.9); border-bottom: 1px solid var(--border); padding: 0 1.5rem; position: sticky; top: 0; z-index: 100; backdrop-filter: blur(12px); }
        .header-inner { max-width: 480px; margin: 0 auto; display: flex; align-items: center; justify-content: space-between; height: 60px; }
        .logo-badge { width: 36px; height: 36px; background: var(--spu); border-radius: 10px; display: flex; align-items: center; justify-content: center; color: white; font-weight: 700; font-size: 11px; }
        .main { max-width: 480px; margin: 0 auto; padding: 1.5rem 1.25rem; }
        .card { background: var(--card); border-radius: var(--radius); border: 1px solid var(--border); box-shadow: var(--shadow); padding: 1.5rem; margin-bottom: 1rem; }
        .lbl { display: block; font-size: 10px; font-weight: 600; color: var(--ink-soft); text-transform: uppercase; margin-bottom: 0.5rem; }
        .input-wrap select, .input-wrap input { width: 100%; background: #fafafa; border: 1.5px solid rgba(0,0,0,0.06); border-radius: 0.875rem; padding: 0.875rem; font-family: 'Kanit', sans-serif; font-size: 0.95rem; margin-bottom: 1rem; outline: none; }
        .btn-calc { width: 100%; background: var(--spu); color: white; border: none; border-radius: 1rem; padding: 1rem; font-weight: 600; cursor: pointer; font-size: 1rem; }
        #resultArea { display: none; margin-top: 1rem; animation: slideUp 0.4s ease; }
        @keyframes slideUp { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
        .result-hero { background: linear-gradient(135deg, var(--spu) 0%, #ff4d9b 100%); border-radius: var(--radius); padding: 1.5rem; color: white; margin-bottom: 0.75rem; text-align: center; }
        .result-value { font-size: 2.2rem; font-weight: 700; }
        .stat-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 0.75rem; margin-bottom: 1rem; }
        .stat-card { background: white; border-radius: var(--radius); border: 1px solid var(--border); padding: 1rem; text-align: center; }
        .status-pill { padding: 4px 12px; border-radius: 99px; font-size: 12px; font-weight: 600; margin-top: 5px; display: inline-block; }
        .status-ok { background: #d1fae5; color: #065f46; }
        .status-tight { background: #fee2e2; color: #991b1b; }
    </style>
</head>
<body>

<header class="header">
    <div class="header-inner">
        <div class="logo-badge">SPU</div>
        <div style="font-size: 11px; font-weight: bold; color: var(--spu);">Engineering Tool</div>
    </div>
</header>

<main class="main">
    <div class="card">
        <h2 style="font-size: 1.2rem; margin-bottom: 1rem; color: var(--spu);">ตารางที่ 4.7 (Wireways)</h2>
        
        <label class="lbl">ขนาดสายไฟฟ้า IEC 01 (mm²)</label>
        <div class="input-wrap">
            <select id="cableSize" onchange="hideResult()">
                <option value="2.5">2.5</option>
                <option value="4">4</option>
                <option value="6">6</option>
                <option value="10">10</option>
                <option value="16">16</option>
                <option value="25">25</option>
                <option value="35">35</option>
                <option value="50">50</option>
                <option value="70">70</option>
                <option value="95">95</option>
                <option value="120">120</option>
                <option value="150">150</option>
                <option value="185">185</option>
                <option value="240">240</option>
                <option value="300">300</option>
            </select>
        </div>

        <label class="lbl">จำนวนสายที่ต้องการเดิน (เส้น)</label>
        <div class="input-wrap">
            <input type="number" id="cableQty" value="10" min="1" oninput="hideResult()">
        </div>

        <button class="btn-calc" onclick="calculate()">ตรวจสอบขนาดรางที่เหมาะสม</button>
    </div>

    <div id="resultArea">
        <div class="result-hero">
            <div style="font-size:12px; opacity:0.9">รางเดินสายที่แนะนำ</div>
            <div class="result-value" id="recSize">—</div>
            <div id="recStatusText" style="margin-top:5px; font-size:0.9rem;">—</div>
        </div>

        <div class="stat-grid">
            <div class="stat-card">
                <div class="lbl">จำนวนสูงสุดที่รับได้</div>
                <div style="font-weight:700; font-size:1.2rem;" id="maxQty">—</div>
            </div>
            <div class="stat-card">
                <div class="lbl">สถานะการติดตั้ง</div>
                <div id="statusBadge">—</div>
            </div>
        </div>

        <div class="card">
            <div class="lbl">เปรียบเทียบขนาดรางทั้งหมด (จำนวนเส้นสูงสุด)</div>
            <div id="compareList" style="font-size: 0.85rem;"></div>
        </div>
    </div>
</main>

<script>
    // ข้อมูลอ้างอิงตรงตาม ตารางที่ 4.7
    // โครงสร้าง: cableSize: { wirewayName: maxQty }
    const table47Data = {
        "2.5": { "50x75": 59 },
        "4":   { "50x75": 45 },
        "6":   { "50x75": 35, "50x100": 47 },
        "10":  { "50x75": 21, "50x100": 28 },
        "16":  { "50x75": 15, "50x100": 20, "75x100": 31, "100x100": 41 },
        "25":  { "50x75": 10, "50x100": 13, "75x100": 20, "100x100": 27 },
        "35":  { "50x75": 8,  "50x100": 10, "75x100": 16, "100x100": 21, "100x150": 32 },
        "50":  { "50x100": 7, "75x100": 11, "100x100": 15, "100x150": 23, "100x200": 31, "100x250": 38 },
        "70":  { "100x150": 17, "100x200": 23, "100x250": 29, "100x300": 35 },
        "95":  { "100x150": 13, "100x200": 17, "100x250": 21, "100x300": 26, "150x300": 39 },
        "120": { "100x250": 17, "100x300": 21, "150x300": 32 },
        "150": { "100x250": 14, "100x300": 17, "150x300": 26 },
        "185": { "150x300": 21 },
        "240": { "150x300": 16 },
        "300": { "150x300": 13 }
    };

    function hideResult() {
        document.getElementById('resultArea').style.display = 'none';
    }

    function calculate() {
        const size = document.getElementById('cableSize').value;
        const qty = parseInt(document.getElementById('cableQty').value) || 0;
        const wirewayOptions = table47Data[size];
        
        let recommended = null;
        let compareHtml = "";

        // เรียงลำดับขนาดรางที่มีให้เลือกสำหรับขนาดสายนั้นๆ
        const names = Object.keys(wirewayOptions);
        
        names.forEach(name => {
            const max = wirewayOptions[name];
            const isFit = qty <= max;
            
            if (isFit && !recommended) {
                recommended = { name, max };
            }

            compareHtml += `
                <div style="display:flex; justify-content:space-between; padding:8px 0; border-bottom:1px solid #eee;">
                    <span>ราง <b>${name}</b></span>
                    <span>รับได้สูงสุด <b>${max}</b> เส้น 
                        ${isFit ? '<span style="color:green"> (ผ่าน)</span>' : '<span style="color:red"> (เกิน)</span>'}
                    </span>
                </div>
            `;
        });

        if (recommended) {
            document.getElementById('recSize').textContent = recommended.name;
            document.getElementById('maxQty').textContent = recommended.max + " เส้น";
            document.getElementById('recStatusText').textContent = "สามารถใช้เดินสายได้ตามมาตรฐาน";
            document.getElementById('statusBadge').innerHTML = '<span class="status-pill status-ok">ผ่านเกณฑ์</span>';
        } else {
            document.getElementById('recSize').textContent = "ไม่พบขนาดราง";
            document.getElementById('maxQty').textContent = "—";
            document.getElementById('recStatusText').textContent = "จำนวนสายเกินกว่าที่รางใหญ่ที่สุดจะรับได้";
            document.getElementById('statusBadge').innerHTML = '<span class="status-pill status-tight">พื้นที่ไม่พอ</span>';
        }

        document.getElementById('compareList').innerHTML = compareHtml;
        document.getElementById('resultArea').style.display = 'block';
    }
</script>

</body>
</html>
