<!DOCTYPE html>

<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>SPU Cable Calc Pro ‚Äî Electrical Engineering Tool</title>
    <link href="https://fonts.googleapis.com/css2?family=Kanit:wght@300;400;500;600;700&family=Space+Mono:wght@400;700&display=swap" rel="stylesheet">
    <style>
        *, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }

```
    :root {
        --spu: #e70274;
        --spu-dark: #b8005c;
        --spu-light: #ff5e9e;
        --spu-pale: #fff0f7;
        --spu-glass: rgba(231, 2, 116, 0.08);
        --ink: #1a0a12;
        --ink-soft: #6b4a5a;
        --surface: #fffafb;
        --card: #ffffff;
        --border: rgba(231, 2, 116, 0.08);
        --shadow: 0 8px 32px -8px rgba(231, 2, 116, 0.18);
        --radius: 1.25rem;
    }

    body {
        font-family: 'Kanit', sans-serif;
        background: var(--surface);
        color: var(--ink);
        min-height: 100vh;
        -webkit-tap-highlight-color: transparent;
        overflow-x: hidden;
    }

    /* Background grain */
    body::before {
        content: '';
        position: fixed;
        inset: 0;
        background-image: url("data:image/svg+xml,%3Csvg viewBox='0 0 256 256' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='noise'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.9' numOctaves='4' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23noise)' opacity='0.04'/%3E%3C/svg%3E");
        pointer-events: none;
        z-index: 0;
    }

    /* Header */
    .header {
        background: white;
        border-bottom: 1px solid var(--border);
        padding: 0 1.5rem;
        position: sticky;
        top: 0;
        z-index: 100;
        backdrop-filter: blur(12px);
    }
    .header-inner {
        max-width: 480px;
        margin: 0 auto;
        display: flex;
        align-items: center;
        justify-content: space-between;
        height: 60px;
    }
    .logo {
        display: flex;
        align-items: center;
        gap: 10px;
    }
    .logo-badge {
        width: 36px;
        height: 36px;
        background: linear-gradient(135deg, var(--spu) 0%, var(--spu-light) 100%);
        border-radius: 10px;
        display: flex;
        align-items: center;
        justify-content: center;
        font-family: 'Space Mono', monospace;
        font-size: 11px;
        color: white;
        font-weight: 700;
        letter-spacing: -0.5px;
        flex-shrink: 0;
    }
    .logo-text { line-height: 1.1; }
    .logo-text strong { display: block; font-size: 12px; color: var(--spu); font-weight: 700; }
    .logo-text span { font-size: 9px; color: var(--ink-soft); font-weight: 300; }
    .version-badge {
        font-family: 'Space Mono', monospace;
        font-size: 10px;
        color: var(--spu);
        background: var(--spu-pale);
        padding: 3px 8px;
        border-radius: 20px;
        border: 1px solid rgba(231,2,116,0.15);
    }

    /* Main layout */
    .main {
        max-width: 480px;
        margin: 0 auto;
        padding: 1.5rem 1.25rem 7rem;
        position: relative;
        z-index: 1;
    }

    .hero {
        text-align: center;
        padding: 1.75rem 0 1.25rem;
    }
    .hero h1 {
        font-size: 1.6rem;
        font-weight: 700;
        color: var(--ink);
        line-height: 1.2;
    }
    .hero h1 span { color: var(--spu); }
    .hero p {
        color: var(--ink-soft);
        font-size: 0.82rem;
        font-weight: 300;
        margin-top: 0.35rem;
    }

    /* Cards */
    .card {
        background: var(--card);
        border-radius: var(--radius);
        border: 1px solid var(--border);
        box-shadow: var(--shadow);
    }
    .form-card { padding: 1.5rem; margin-bottom: 1rem; }

    /* Label */
    .lbl {
        display: block;
        font-size: 10px;
        font-weight: 600;
        color: var(--ink-soft);
        letter-spacing: 0.12em;
        text-transform: uppercase;
        margin-bottom: 0.5rem;
    }

    /* Inputs */
    .input-wrap { position: relative; }
    .input-wrap select, .input-wrap input {
        width: 100%;
        background: #fafafa;
        border: 1.5px solid rgba(0,0,0,0.06);
        border-radius: 0.875rem;
        padding: 0.875rem 1rem;
        font-family: 'Kanit', sans-serif;
        font-size: 0.95rem;
        color: var(--ink);
        outline: none;
        transition: border-color 0.2s, box-shadow 0.2s;
        appearance: none;
    }
    .input-wrap select:focus, .input-wrap input:focus {
        border-color: var(--spu);
        box-shadow: 0 0 0 3px rgba(231,2,116,0.1);
        background: white;
    }
    .input-icon {
        position: absolute;
        right: 1rem;
        top: 50%;
        transform: translateY(-50%);
        color: var(--ink-soft);
        pointer-events: none;
        opacity: 0.5;
    }
    input[type="number"] { text-align: center; font-weight: 600; font-size: 1.1rem; }

    /* Grid */
    .grid2 { display: grid; grid-template-columns: 1fr 1fr; gap: 0.75rem; }

    /* Radio pills */
    .radio-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 0.6rem; }
    .radio-option { position: relative; }
    .radio-option input { display: none; }
    .radio-face {
        display: flex;
        align-items: center;
        justify-content: center;
        gap: 7px;
        padding: 0.75rem 0.5rem;
        border-radius: 0.875rem;
        border: 1.5px solid rgba(0,0,0,0.07);
        background: #fafafa;
        font-size: 0.85rem;
        font-weight: 500;
        color: var(--ink-soft);
        cursor: pointer;
        transition: all 0.2s;
        text-align: center;
    }
    .radio-option input:checked + .radio-face {
        border-color: var(--spu);
        background: var(--spu-pale);
        color: var(--spu);
        box-shadow: 0 0 0 1px var(--spu);
    }
    .radio-face svg { flex-shrink: 0; }

    /* CTA Button */
    .btn-calc {
        width: 100%;
        background: linear-gradient(135deg, var(--spu) 0%, var(--spu-light) 100%);
        color: white;
        border: none;
        border-radius: 1rem;
        padding: 1rem;
        font-family: 'Kanit', sans-serif;
        font-size: 1rem;
        font-weight: 600;
        cursor: pointer;
        letter-spacing: 0.03em;
        transition: transform 0.15s, box-shadow 0.15s;
        box-shadow: 0 6px 20px -4px rgba(231,2,116,0.45);
        display: flex;
        align-items: center;
        justify-content: center;
        gap: 8px;
    }
    .btn-calc:active { transform: scale(0.97); box-shadow: 0 2px 10px -4px rgba(231,2,116,0.4); }

    /* Result area */
    #resultArea { display: none; animation: slideUp 0.45s cubic-bezier(0.22,1,0.36,1) both; }
    #resultArea.show { display: block; }
    @keyframes slideUp {
        from { opacity: 0; transform: translateY(20px); }
        to { opacity: 1; transform: translateY(0); }
    }

    /* Hero result card */
    .result-hero {
        background: linear-gradient(135deg, var(--spu) 0%, #ff4d9b 50%, #ff8dc0 100%);
        border-radius: var(--radius);
        padding: 1.5rem;
        color: white;
        position: relative;
        overflow: hidden;
        margin-bottom: 0.75rem;
    }
    .result-hero::before {
        content: '';
        position: absolute;
        width: 180px; height: 180px;
        background: rgba(255,255,255,0.08);
        border-radius: 50%;
        right: -60px; top: -60px;
    }
    .result-hero::after {
        content: '';
        position: absolute;
        width: 100px; height: 100px;
        background: rgba(255,255,255,0.06);
        border-radius: 50%;
        left: -30px; bottom: -40px;
    }
    .result-label {
        font-size: 9px;
        font-weight: 600;
        letter-spacing: 0.18em;
        text-transform: uppercase;
        opacity: 0.75;
        margin-bottom: 0.3rem;
    }
    .result-value {
        font-size: 2rem;
        font-weight: 700;
        line-height: 1.1;
        position: relative;
        z-index: 1;
    }
    .result-sub {
        font-size: 0.78rem;
        opacity: 0.7;
        margin-top: 0.25rem;
        font-weight: 300;
        position: relative;
        z-index: 1;
    }
    .result-fill-bar {
        margin-top: 1rem;
        background: rgba(255,255,255,0.2);
        border-radius: 99px;
        height: 6px;
        position: relative;
        z-index: 1;
    }
    .result-fill-inner {
        height: 100%;
        border-radius: 99px;
        background: white;
        transition: width 0.8s cubic-bezier(0.22,1,0.36,1);
    }
    .fill-label {
        display: flex;
        justify-content: space-between;
        font-size: 10px;
        opacity: 0.75;
        margin-top: 0.35rem;
        position: relative;
        z-index: 1;
    }

    /* Stat cards */
    .stat-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 0.75rem; margin-bottom: 0.75rem; }
    .stat-card {
        background: white;
        border-radius: calc(var(--radius) - 2px);
        border: 1px solid var(--border);
        padding: 1rem;
        text-align: center;
    }
    .stat-card .stat-title {
        font-size: 9px;
        font-weight: 600;
        letter-spacing: 0.12em;
        text-transform: uppercase;
        color: var(--ink-soft);
        margin-bottom: 0.3rem;
    }
    .stat-card .stat-val { font-size: 1.15rem; font-weight: 700; color: var(--ink); }
    .stat-card .stat-val.ok { color: #10b981; }
    .stat-card .stat-val.warn { color: #f59e0b; }
    .stat-card .stat-val.danger { color: #ef4444; }

    /* Compare section */
    .compare-card { padding: 1.25rem; margin-bottom: 0.75rem; }
    .compare-header {
        display: flex;
        align-items: center;
        justify-content: space-between;
        margin-bottom: 1rem;
    }
    .compare-header h3 {
        font-size: 0.8rem;
        font-weight: 600;
        color: var(--ink);
        letter-spacing: 0.05em;
    }
    .tag-count {
        font-size: 10px;
        font-weight: 600;
        color: var(--spu);
        background: var(--spu-pale);
        padding: 2px 8px;
        border-radius: 99px;
        border: 1px solid rgba(231,2,116,0.15);
    }

    /* Size chips */
    .size-chips { display: flex; flex-wrap: wrap; gap: 0.5rem; }
    .size-chip {
        display: flex;
        align-items: center;
        gap: 6px;
        padding: 0.5rem 0.85rem;
        border-radius: 0.75rem;
        border: 1.5px solid var(--border);
        background: white;
        font-size: 0.82rem;
        font-weight: 500;
        color: var(--ink-soft);
        cursor: pointer;
        transition: all 0.18s;
        font-family: 'Space Mono', monospace;
    }
    .size-chip:hover, .size-chip:active {
        border-color: var(--spu);
        background: var(--spu-pale);
        color: var(--spu);
        transform: translateY(-1px);
        box-shadow: 0 4px 12px -4px rgba(231,2,116,0.25);
    }
    .size-chip.recommended {
        border-color: var(--spu);
        background: var(--spu-pale);
        color: var(--spu);
    }
    .chip-dot {
        width: 6px; height: 6px;
        border-radius: 50%;
        background: currentColor;
    }

    /* Modal */
    .modal-overlay {
        display: none;
        position: fixed;
        inset: 0;
        background: rgba(26, 10, 18, 0.65);
        backdrop-filter: blur(8px);
        z-index: 200;
        align-items: flex-end;
    }
    .modal-overlay.open { display: flex; animation: fadeIn 0.2s ease; }
    @keyframes fadeIn { from { opacity:0; } to { opacity:1; } }

    .modal-sheet {
        width: 100%;
        max-width: 480px;
        margin: 0 auto;
        background: white;
        border-radius: 1.75rem 1.75rem 0 0;
        max-height: 90vh;
        overflow-y: auto;
        animation: sheetUp 0.35s cubic-bezier(0.22,1,0.36,1);
    }
    @keyframes sheetUp {
        from { transform: translateY(100%); }
        to { transform: translateY(0); }
    }

    .modal-handle {
        width: 40px; height: 4px;
        background: rgba(0,0,0,0.1);
        border-radius: 2px;
        margin: 0.875rem auto 0;
    }
    .modal-header {
        padding: 1rem 1.5rem 0.75rem;
        border-bottom: 1px solid var(--border);
    }
    .modal-title { font-size: 1.05rem; font-weight: 700; color: var(--ink); }
    .modal-sub { font-size: 0.78rem; color: var(--ink-soft); font-weight: 300; margin-top: 0.15rem; }
    .modal-body { padding: 1rem 1.25rem 2rem; }

    /* Compare table */
    .compare-table { width: 100%; border-collapse: separate; border-spacing: 0; }
    .compare-table th {
        font-size: 9px;
        font-weight: 700;
        letter-spacing: 0.12em;
        text-transform: uppercase;
        color: var(--ink-soft);
        padding: 0.6rem 0.75rem;
        text-align: left;
        background: #fafafa;
    }
    .compare-table th:first-child { border-radius: 0.75rem 0 0 0.75rem; }
    .compare-table th:last-child { border-radius: 0 0.75rem 0.75rem 0; }
    .compare-table td {
        padding: 0.875rem 0.75rem;
        font-size: 0.88rem;
        border-bottom: 1px solid rgba(0,0,0,0.04);
        vertical-align: middle;
    }
    .compare-table tr.rec-row td { background: var(--spu-pale); }
    .compare-table tr.rec-row td:first-child { border-left: 3px solid var(--spu); }
    .compare-row-name { font-weight: 600; font-family: 'Space Mono', monospace; font-size: 0.82rem; }
    .compare-row-name .rec-tag {
        display: inline-block;
        font-size: 8px;
        font-family: 'Kanit', sans-serif;
        background: var(--spu);
        color: white;
        padding: 1px 6px;
        border-radius: 99px;
        margin-left: 4px;
        vertical-align: middle;
    }

    /* Fill bar in table */
    .mini-bar-wrap { display: flex; align-items: center; gap: 6px; }
    .mini-bar {
        flex: 1;
        height: 6px;
        background: rgba(0,0,0,0.06);
        border-radius: 99px;
        overflow: hidden;
    }
    .mini-bar-fill {
        height: 100%;
        border-radius: 99px;
        transition: width 0.6s ease;
    }
    .mini-bar-pct {
        font-size: 10px;
        font-weight: 600;
        color: var(--ink-soft);
        font-family: 'Space Mono', monospace;
        min-width: 36px;
        text-align: right;
    }

    /* Status pill */
    .status-pill {
        display: inline-block;
        font-size: 9px;
        font-weight: 600;
        padding: 2px 8px;
        border-radius: 99px;
        font-family: 'Kanit', sans-serif;
    }
    .status-ok { background: #d1fae5; color: #065f46; }
    .status-warn { background: #fef3c7; color: #92400e; }
    .status-tight { background: #fee2e2; color: #991b1b; }

    /* Footer */
    .footer-bar {
        position: fixed;
        bottom: 0; left: 0; width: 100%;
        background: rgba(255,255,255,0.92);
        backdrop-filter: blur(16px);
        border-top: 1px solid var(--border);
        z-index: 99;
    }
    .footer-inner {
        max-width: 480px;
        margin: 0 auto;
        padding: 0.75rem 1.5rem;
        display: flex;
        align-items: center;
        justify-content: space-between;
    }
    .footer-brand { display: flex; align-items: center; gap: 10px; }
    .footer-logo {
        width: 32px; height: 32px;
        background: linear-gradient(135deg, var(--spu), var(--spu-light));
        border-radius: 8px;
        display: flex;
        align-items: center;
        justify-content: center;
        font-family: 'Space Mono', monospace;
        font-size: 9px;
        color: white;
        font-weight: 700;
    }
    .footer-text strong { display: block; font-size: 11px; font-weight: 700; color: var(--spu); }
    .footer-text span { font-size: 9px; color: var(--ink-soft); font-weight: 300; }
    .footer-standard {
        font-size: 9px;
        color: var(--ink-soft);
        font-family: 'Space Mono', monospace;
        text-align: right;
        line-height: 1.5;
    }

    /* Divider */
    .divider {
        height: 1px;
        background: linear-gradient(90deg, transparent, var(--border), transparent);
        margin: 0.75rem 0;
    }

    /* Info note */
    .info-note {
        display: flex;
        align-items: flex-start;
        gap: 8px;
        background: var(--spu-glass);
        border-radius: 0.875rem;
        padding: 0.875rem 1rem;
        margin-top: 0.75rem;
    }
    .info-note p { font-size: 0.78rem; color: var(--ink-soft); line-height: 1.5; font-weight: 300; }
    .info-note strong { font-weight: 600; color: var(--spu); }

    /* Section sep */
    .section-sep {
        display: flex;
        align-items: center;
        gap: 8px;
        margin: 1.25rem 0 0.75rem;
    }
    .section-sep span {
        font-size: 9px;
        font-weight: 700;
        color: var(--ink-soft);
        letter-spacing: 0.15em;
        text-transform: uppercase;
        white-space: nowrap;
    }
    .section-sep::before, .section-sep::after {
        content: '';
        flex: 1;
        height: 1px;
        background: var(--border);
    }
</style>
```

</head>
<body>

<!-- Header -->

<header class="header">
    <div class="header-inner">
        <div class="logo">
            <div class="logo-badge">SPU</div>
            <div class="logo-text">
                <strong>Cable Calc Pro</strong>
                <span>Faculty of Engineering</span>
            </div>
        </div>
        <div class="version-badge">v2.0</div>
    </div>
</header>

<!-- Main -->

<main class="main">
    <div class="hero">
        <h1>‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì<span>‡∏™‡∏≤‡∏¢&‡∏ó‡πà‡∏≠</span>‡πÑ‡∏ü‡∏ü‡πâ‡∏≤</h1>
        <p>‡∏≠‡πâ‡∏≤‡∏á‡∏≠‡∏¥‡∏á IEC 60364 ¬∑ ‡∏°‡∏≤‡∏ï‡∏£‡∏ê‡∏≤‡∏ô ‡∏Å‡∏ü‡∏ô./‡∏Å‡∏ü‡∏†. ¬∑ EIT</p>
    </div>

```
<!-- Form card -->
<div class="card form-card">
    <!-- Cable type -->
    <div style="margin-bottom:1.1rem">
        <label class="lbl">‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏™‡∏≤‡∏¢‡πÑ‡∏ü‡∏ü‡πâ‡∏≤</label>
        <div class="input-wrap">
            <select id="cableType" onchange="updateSizes()">
                <option value="iec01">IEC 01 (THW) ‚Äî ‡πÄ‡∏î‡∏µ‡πà‡∏¢‡∏ß‡∏â‡∏ô‡∏ß‡∏ô PVC</option>
                <option value="nyy1c">NYY 1/C ‚Äî ‡πÄ‡∏õ‡∏•‡∏∑‡∏≠‡∏Å PVC ‡∏ä‡∏±‡πâ‡∏ô‡πÄ‡∏î‡∏µ‡∏¢‡∏ß</option>
                <option value="xlpe1c">XLPE 1/C ‚Äî ‡∏â‡∏ô‡∏ß‡∏ô Cross-Linked PE</option>
            </select>
            <span class="input-icon">
                <svg width="14" height="14" viewBox="0 0 20 20" fill="currentColor"><path d="M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z"/></svg>
            </span>
        </div>
    </div>

    <!-- Size + Qty -->
    <div class="grid2" style="margin-bottom:1.1rem">
        <div>
            <label class="lbl">‡∏Ç‡∏ô‡∏≤‡∏î‡∏™‡∏≤‡∏¢ (mm¬≤)</label>
            <div class="input-wrap">
                <select id="cableSize"></select>
                <span class="input-icon">
                    <svg width="14" height="14" viewBox="0 0 20 20" fill="currentColor"><path d="M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z"/></svg>
                </span>
            </div>
        </div>
        <div>
            <label class="lbl">‡∏à‡∏≥‡∏ô‡∏ß‡∏ô (‡πÄ‡∏™‡πâ‡∏ô)</label>
            <div class="input-wrap">
                <input type="number" id="cableQty" value="3" min="1" max="50">
            </div>
        </div>
    </div>

    <!-- Install type -->
    <div style="margin-bottom:1.25rem">
        <label class="lbl" style="text-align:center;display:block;margin-bottom:0.6rem">‡∏£‡∏∞‡∏ö‡∏ö‡∏Å‡∏≤‡∏£‡∏ï‡∏¥‡∏î‡∏ï‡∏±‡πâ‡∏á</label>
        <div class="radio-grid">
            <label class="radio-option">
                <input type="radio" name="installType" value="conduit" checked>
                <div class="radio-face">
                    <svg width="15" height="15" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="10"/><circle cx="12" cy="12" r="4"/></svg>
                    ‡∏ó‡πà‡∏≠‡∏£‡πâ‡∏≠‡∏¢‡∏™‡∏≤‡∏¢
                </div>
            </label>
            <label class="radio-option">
                <input type="radio" name="installType" value="wireway">
                <div class="radio-face">
                    <svg width="15" height="15" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="2" y="7" width="20" height="10" rx="2"/><line x1="2" y1="12" x2="22" y2="12"/></svg>
                    ‡∏£‡∏≤‡∏á‡πÄ‡∏î‡∏¥‡∏ô‡∏™‡∏≤‡∏¢
                </div>
            </label>
        </div>
    </div>

    <button class="btn-calc" onclick="calculate()">
        <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5"><path d="M9 3H5a2 2 0 00-2 2v4"/><path d="M9 3h10a2 2 0 012 2v4"/><path d="M3 9v10a2 2 0 002 2h10"/><path d="M14 21h5a2 2 0 002-2v-5"/><rect x="7" y="7" width="4" height="4" rx="1"/><rect x="13" y="13" width="4" height="4" rx="1"/><line x1="7" y1="17" x2="11" y2="17"/><line x1="13" y1="7" x2="17" y2="7"/></svg>
        ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏Ç‡∏ô‡∏≤‡∏î‡∏ó‡πà‡∏≠ / ‡∏£‡∏≤‡∏á
    </button>
</div>

<!-- Results -->
<div id="resultArea">
    <!-- Hero result -->
    <div class="result-hero">
        <div class="result-label">‡∏Ç‡∏ô‡∏≤‡∏î‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥‡∏ï‡∏≤‡∏°‡∏°‡∏≤‡∏ï‡∏£‡∏ê‡∏≤‡∏ô</div>
        <div class="result-value" id="recSize">‚Äî</div>
        <div class="result-sub" id="recSub">‚Äî</div>
        <div class="result-fill-bar">
            <div class="result-fill-inner" id="fillBar" style="width:0%"></div>
        </div>
        <div class="fill-label">
            <span>‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà‡∏ß‡πà‡∏≤‡∏á‡∏ó‡∏µ‡πà‡πÉ‡∏ä‡πâ</span>
            <span id="fillPct">0%</span>
        </div>
    </div>

    <!-- Stats -->
    <div class="stat-grid">
        <div class="stat-card">
            <div class="stat-title">‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà‡∏ï‡∏±‡∏î‡∏Ç‡∏ß‡∏≤‡∏á‡∏£‡∏ß‡∏°</div>
            <div class="stat-val" id="totalArea">‚Äî</div>
        </div>
        <div class="stat-card">
            <div class="stat-title">‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà‡∏ß‡πà‡∏≤‡∏á‡∏Ñ‡∏á‡πÄ‡∏´‡∏•‡∏∑‡∏≠</div>
            <div class="stat-val" id="remainPct">‚Äî</div>
        </div>
    </div>

    <!-- Compare section -->
    <div class="card compare-card">
        <div class="compare-header">
            <h3>üîç ‡πÄ‡∏õ‡∏£‡∏µ‡∏¢‡∏ö‡πÄ‡∏ó‡∏µ‡∏¢‡∏ö‡∏Ç‡∏ô‡∏≤‡∏î‡∏≠‡∏∑‡πà‡∏ô‡πÜ</h3>
            <span class="tag-count" id="availCount">0 ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£</span>
        </div>
        <div class="size-chips" id="sizeChips"></div>
        <div class="info-note" style="margin-top:0.875rem">
            <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="#e70274" stroke-width="2" style="flex-shrink:0;margin-top:2px"><circle cx="12" cy="12" r="10"/><line x1="12" y1="8" x2="12" y2="12"/><line x1="12" y1="16" x2="12.01" y2="16"/></svg>
            <p>‡πÅ‡∏ï‡∏∞‡∏ó‡∏µ‡πà‡∏Ç‡∏ô‡∏≤‡∏î‡∏ï‡πà‡∏≤‡∏á‡πÜ ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏î‡∏π<strong>‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏Å‡∏≤‡∏£‡πÄ‡∏õ‡∏£‡∏µ‡∏¢‡∏ö‡πÄ‡∏ó‡∏µ‡∏¢‡∏ö</strong>‡πÅ‡∏•‡∏∞‡∏Ñ‡πà‡∏≤‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà‡∏ó‡∏µ‡πà‡πÄ‡∏´‡∏•‡∏∑‡∏≠</p>
        </div>
    </div>

    <!-- Standard note -->
    <div class="info-note" style="margin-bottom:0.75rem">
        <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="#e70274" stroke-width="2" style="flex-shrink:0;margin-top:1px"><path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"/></svg>
        <p>‡∏°‡∏≤‡∏ï‡∏£‡∏ê‡∏≤‡∏ô: <strong>‡∏ó‡πà‡∏≠‡∏£‡πâ‡∏≠‡∏¢‡∏™‡∏≤‡∏¢ ‚â§ 40%</strong> ‡∏Ç‡∏≠‡∏á‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà‡∏´‡∏ô‡πâ‡∏≤‡∏ï‡∏±‡∏î‡∏ó‡πà‡∏≠ | <strong>‡∏£‡∏≤‡∏á‡πÄ‡∏î‡∏¥‡∏ô‡∏™‡∏≤‡∏¢ ‚â§ 20%</strong> ‡∏ï‡∏≤‡∏° ‡∏ß‡∏™‡∏ó. / IEC 60364-5-52</p>
    </div>
</div>
```

</main>

<!-- Footer -->

<footer class="footer-bar">
    <div class="footer-inner">
        <div class="footer-brand">
            <div class="footer-logo">SPU</div>
            <div class="footer-text">
                <strong>Sripatum University</strong>
                <span>Faculty of Engineering</span>
            </div>
        </div>
        <div class="footer-standard">
            <div>IEC 60364 ¬∑ ‡∏ß‡∏™‡∏ó.</div>
            <div>‡∏Å‡∏ü‡∏ô. / ‡∏Å‡∏ü‡∏†. Standard</div>
        </div>
    </div>
</footer>

<!-- Compare Modal -->

<div class="modal-overlay" id="compareModal" onclick="closeModal(event)">
    <div class="modal-sheet">
        <div class="modal-handle"></div>
        <div class="modal-header">
            <div class="modal-title" id="modalTitle">‡πÄ‡∏õ‡∏£‡∏µ‡∏¢‡∏ö‡πÄ‡∏ó‡∏µ‡∏¢‡∏ö‡∏Ç‡∏ô‡∏≤‡∏î</div>
            <div class="modal-sub" id="modalSub">‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà‡∏ó‡∏∏‡∏Å‡∏Ç‡∏ô‡∏≤‡∏î‡∏ó‡∏µ‡πà‡πÄ‡∏õ‡πá‡∏ô‡πÑ‡∏õ‡πÑ‡∏î‡πâ</div>
        </div>
        <div class="modal-body">
            <table class="compare-table" id="compareTable">
                <thead>
                    <tr>
                        <th>‡∏Ç‡∏ô‡∏≤‡∏î</th>
                        <th>‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà‡∏ß‡πà‡∏≤‡∏á (mm¬≤)</th>
                        <th>‡∏™‡∏±‡∏î‡∏™‡πà‡∏ß‡∏ô‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ</th>
                        <th>‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞</th>
                    </tr>
                </thead>
                <tbody id="compareBody"></tbody>
            </table>

```
        <div class="section-sep"><span>‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏≠‡πâ‡∏≤‡∏á‡∏≠‡∏¥‡∏á</span></div>
        <div id="modalDetail" style="font-size:0.82rem;color:var(--ink-soft);line-height:1.7;font-weight:300"></div>
    </div>
</div>
```

</div>

<script>
    // ============================
    //  DATA
    // ============================
    const cableData = {
        iec01:  { "1.5":8.5,"2.5":12.5,"4":16.6,"6":21.2,"10":35.2,"16":47.7,"25":73.8,"35":93.9,"50":129,"70":167,"95":230,"120":278,"150":343 },
        nyy1c:  { "1":60.8,"1.5":66.5,"2.5":75.4,"4":86.6,"6":95,"10":113,"16":133,"25":165,"35":201,"50":227,"70":284,"95":363,"120":416 },
        xlpe1c: { "1.5":33.1,"2.5":38.4,"4":44.1,"6":50.2,"10":56.7,"16":70.8,"25":104,"35":123,"50":154,"70":189,"95":241 }
    };
    const cableTypeNames = { iec01:"IEC 01 (THW)", nyy1c:"NYY 1/C", xlpe1c:"XLPE 1/C" };

    const conduitData = [
        { name:'1/2"',  area:71   },
        { name:'3/4"',  area:126  },
        { name:'1"',    area:196  },
        { name:'1¬º"',   area:322  },
        { name:'1¬Ω"',   area:503  },
        { name:'2"',    area:785  },
        { name:'2¬Ω"',   area:1327 },
        { name:'3"',    area:2011 }
    ];
    const wirewayData = [
        { name:"50√ó75",   area:750  },
        { name:"50√ó100",  area:1000 },
        { name:"75√ó100",  area:1500 },
        { name:"100√ó100", area:2000 },
        { name:"100√ó150", area:3000 },
        { name:"150√ó150", area:4500 },
        { name:"150√ó200", area:6000 }
    ];

    const LIMIT_CONDUIT = 0.40;
    const LIMIT_WIREWAY = 0.20;

    // ============================
    //  Init size dropdown
    // ============================
    function updateSizes() {
        const type = document.getElementById('cableType').value;
        const sel = document.getElementById('cableSize');
        sel.innerHTML = '';
        Object.keys(cableData[type]).forEach(s => {
            const o = document.createElement('option');
            o.value = s; o.textContent = s;
            sel.appendChild(o);
        });
    }
    updateSizes();

    // ============================
    //  State
    // ============================
    let lastCalc = null;

    // ============================
    //  Calculate
    // ============================
    function calculate() {
        const type     = document.getElementById('cableType').value;
        const size     = document.getElementById('cableSize').value;
        const qty      = Math.max(1, parseInt(document.getElementById('cableQty').value) || 1);
        const install  = document.querySelector('input[name="installType"]:checked').value;

        const unitArea     = cableData[type][size];
        const totalCable   = unitArea * qty;
        const limit        = install === 'conduit' ? LIMIT_CONDUIT : LIMIT_WIREWAY;
        const dataset      = install === 'conduit' ? conduitData : wirewayData;
        const minContainer = totalCable / limit;

        const validOptions = dataset.filter(c => c.area >= minContainer);
        const allOptions   = dataset.map(c => {
            const usedFrac = totalCable / c.area;
            const usedPct  = (usedFrac * 100).toFixed(1);
            const fits     = c.area >= minContainer;
            return { ...c, usedPct, fits, usedFrac };
        });

        lastCalc = { type, size, qty, install, unitArea, totalCable, limit, dataset, validOptions, allOptions, minContainer };

        renderResult(lastCalc);
    }

    function getStatusInfo(usedFrac, limit) {
        const pct = usedFrac * 100;
        if (usedFrac > 1) return { label:'‡πÄ‡∏ï‡πá‡∏°‡πÅ‡∏•‡πâ‡∏ß', cls:'status-tight', barColor:'#ef4444' };
        if (usedFrac > limit) return { label:'‡πÄ‡∏Å‡∏¥‡∏ô‡∏°‡∏≤‡∏ï‡∏£‡∏ê‡∏≤‡∏ô', cls:'status-tight', barColor:'#ef4444' };
        if (pct >= (limit*100 - 10)) return { label:'‡πÉ‡∏Å‡∏•‡πâ‡πÄ‡∏ï‡πá‡∏°', cls:'status-warn', barColor:'#f59e0b' };
        return { label:'‡∏ú‡πà‡∏≤‡∏ô‡∏°‡∏≤‡∏ï‡∏£‡∏ê‡∏≤‡∏ô', cls:'status-ok', barColor:'#10b981' };
    }

    function renderResult(c) {
        const ra = document.getElementById('resultArea');
        ra.classList.add('show');

        // Hero
        if (c.validOptions.length > 0) {
            const rec = c.validOptions[0];
            const usedFrac = c.totalCable / rec.area;
            const usedPct = (usedFrac * 100).toFixed(1);
            const remainPct = (100 - usedFrac * 100).toFixed(1);
            const prefix = c.install === 'conduit' ? '‡∏ó‡πà‡∏≠ ' : '‡∏£‡∏≤‡∏á ';

            document.getElementById('recSize').textContent = prefix + rec.name;
            document.getElementById('recSub').textContent = `‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà‡∏ó‡πà‡∏≠ ${rec.area} mm¬≤ ¬∑ ‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô ${usedPct}% (‡∏Ç‡∏µ‡∏î‡∏à‡∏≥‡∏Å‡∏±‡∏î ${c.limit*100}%)`;
            setTimeout(() => {
                document.getElementById('fillBar').style.width = usedPct + '%';
                document.getElementById('fillPct').textContent = usedPct + '%';
            }, 100);

            document.getElementById('totalArea').textContent = c.totalCable.toFixed(1) + ' mm¬≤';
            const rEl = document.getElementById('remainPct');
            rEl.textContent = remainPct + '%';
            rEl.className = 'stat-val ' + (parseFloat(remainPct) < 15 ? 'warn' : 'ok');
        } else {
            document.getElementById('recSize').textContent = '‡πÄ‡∏Å‡∏¥‡∏ô‡∏Ç‡∏ô‡∏≤‡∏î‡∏°‡∏≤‡∏ï‡∏£‡∏ê‡∏≤‡∏ô';
            document.getElementById('recSub').textContent = '‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏Ç‡∏ô‡∏≤‡∏î‡πÉ‡∏´‡∏ç‡πà‡∏Å‡∏ß‡πà‡∏≤‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡πÉ‡∏ô‡∏ê‡∏≤‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•';
            document.getElementById('fillBar').style.width = '100%';
            document.getElementById('fillPct').textContent = '>100%';
            document.getElementById('totalArea').textContent = c.totalCable.toFixed(1) + ' mm¬≤';
            document.getElementById('remainPct').textContent = 'N/A';
            document.getElementById('remainPct').className = 'stat-val danger';
        }

        // Chips
        const chips = document.getElementById('sizeChips');
        chips.innerHTML = '';
        document.getElementById('availCount').textContent = c.validOptions.length + ' ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£';

        const prefix = c.install === 'conduit' ? '‡∏ó‡πà‡∏≠ ' : '‡∏£‡∏≤‡∏á ';
        c.allOptions.forEach((opt, i) => {
            const chip = document.createElement('button');
            chip.className = 'size-chip' + (!opt.fits ? ' size-chip-off' : '') + (i === 0 && opt.fits ? ' recommended' : '');
            chip.style.opacity = opt.fits ? '1' : '0.45';
            chip.innerHTML = `<span class="chip-dot"></span>${prefix}${opt.name}`;
            chip.onclick = () => openModal(opt, c, i);
            chips.appendChild(chip);
        });

        window.scrollTo({ top: document.body.scrollHeight, behavior: 'smooth' });
    }

    // ============================
    //  Modal
    // ============================
    function openModal(selectedOpt, c, selectedIdx) {
        const prefix = c.install === 'conduit' ? '‡∏ó‡πà‡∏≠ ' : '‡∏£‡∏≤‡∏á ';
        document.getElementById('modalTitle').textContent = `‡πÄ‡∏õ‡∏£‡∏µ‡∏¢‡∏ö‡πÄ‡∏ó‡∏µ‡∏¢‡∏ö ${prefix + selectedOpt.name}`;
        document.getElementById('modalSub').textContent =
            `‡∏™‡∏≤‡∏¢ ${cableTypeNames[c.type]} ${c.size} mm¬≤ √ó ${c.qty} ‡πÄ‡∏™‡πâ‡∏ô | ‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà‡∏£‡∏ß‡∏° ${c.totalCable.toFixed(1)} mm¬≤`;

        const tbody = document.getElementById('compareBody');
        tbody.innerHTML = '';

        c.allOptions.forEach((opt, i) => {
            const tr = document.createElement('tr');
            if (i === selectedIdx) tr.classList.add('rec-row');
            const si = getStatusInfo(opt.usedFrac, c.limit);
            const displayPct = Math.min(opt.usedFrac * 100, 100);

            tr.innerHTML = `
                <td>
                    <div class="compare-row-name">${opt.name}${i === 0 && opt.fits ? '<span class="rec-tag">‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥</span>' : ''}</div>
                    <div style="font-size:9px;color:var(--ink-soft);margin-top:2px">${opt.area} mm¬≤</div>
                </td>
                <td style="font-family:'Space Mono',monospace;font-size:0.82rem">${opt.fits ? (opt.area - c.totalCable).toFixed(1) : '‚Äî'}</td>
                <td>
                    <div class="mini-bar-wrap">
                        <div class="mini-bar">
                            <div class="mini-bar-fill" style="width:${Math.min(displayPct,100)}%;background:${si.barColor}"></div>
                        </div>
                        <span class="mini-bar-pct">${opt.usedPct}%</span>
                    </div>
                </td>
                <td><span class="status-pill ${si.cls}">${si.label}</span></td>
            `;
            tbody.appendChild(tr);
        });

        // Detail note
        const limitText = c.install === 'conduit' ? '40% ‡∏ï‡∏≤‡∏°‡∏°‡∏≤‡∏ï‡∏£‡∏ê‡∏≤‡∏ô NEC/IEC ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ó‡πà‡∏≠‡∏£‡πâ‡∏≠‡∏¢‡∏™‡∏≤‡∏¢' : '20% ‡∏ï‡∏≤‡∏°‡∏°‡∏≤‡∏ï‡∏£‡∏ê‡∏≤‡∏ô IEC 60364-5-52 ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏£‡∏≤‡∏á‡πÄ‡∏î‡∏¥‡∏ô‡∏™‡∏≤‡∏¢';
        document.getElementById('modalDetail').innerHTML = `
            <strong>‡∏™‡∏≤‡∏¢‡∏ó‡∏µ‡πà‡πÄ‡∏•‡∏∑‡∏≠‡∏Å:</strong> ${cableTypeNames[c.type]} ‡∏Ç‡∏ô‡∏≤‡∏î ${c.size} mm¬≤ ‡∏à‡∏≥‡∏ô‡∏ß‡∏ô ${c.qty} ‡πÄ‡∏™‡πâ‡∏ô<br>
            <strong>‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà‡∏ï‡∏±‡∏î‡∏Ç‡∏ß‡∏≤‡∏á‡∏ï‡πà‡∏≠‡πÄ‡∏™‡πâ‡∏ô:</strong> ${c.unitArea} mm¬≤<br>
            <strong>‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà‡∏£‡∏ß‡∏°‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î:</strong> ${c.totalCable.toFixed(2)} mm¬≤<br>
            <strong>‡∏Ç‡∏µ‡∏î‡∏à‡∏≥‡∏Å‡∏±‡∏î‡∏°‡∏≤‡∏ï‡∏£‡∏ê‡∏≤‡∏ô:</strong> ${limitText}<br>
            <strong>‡∏Ç‡∏ô‡∏≤‡∏î‡∏ó‡∏µ‡πà‡πÄ‡∏•‡πá‡∏Å‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î‡∏ó‡∏µ‡πà‡∏ú‡πà‡∏≤‡∏ô‡∏°‡∏≤‡∏ï‡∏£‡∏ê‡∏≤‡∏ô:</strong> ${c.validOptions.length > 0 ? prefix + c.validOptions[0].name : '‡πÑ‡∏°‡πà‡∏°‡∏µ‡πÉ‡∏ô‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£'}
        `;

        document.getElementById('compareModal').classList.add('open');
        document.body.style.overflow = 'hidden';
    }

    function closeModal(e) {
        if (e.target === document.getElementById('compareModal')) {
            document.getElementById('compareModal').classList.remove('open');
            document.body.style.overflow = '';
        }
    }
</script>

</body>
</html>